import{h as se,n as R,s as ce,o as _,c as y,w as s,a as o,p as B,F as j,q as A,x as c,y as G,z as S,I as ie,B as le,A as re,D as ue,E as V,G as b,H as m,T as _e,J as de,K as J,L as pe,M as me,O as fe,P as he,Q,j as q,R as X,S as ge,U as be,r as Y,V as P,W as ve,X as ye,Y as ke,Z as Le,_ as K,$ as Te,a0 as H,a1 as E,a2 as we,a3 as Ie,a4 as Se,a5 as Ce,a6 as Me,a7 as $e,a8 as Z,a9 as Be,aa as De,ab as xe,ac as Re,ad as Ee,ae as qe,af as Fe,ag as ze,ah as Ue,ai as je,aj as Ae,ak as Ke,al as Ne,am as Pe,an as Ve,ao as Oe,ap as He,aq as We,ar as W,as as Ge,at as Je,au as Qe,av as Xe,aw as Ye}from"./mP1IfPKX.js";import{i as Ze,u as et,_ as F,a as x,l as tt,r as nt,b as at,s as ee}from"./Bosq37yR.js";import{u as ot,_ as st}from"./D8hEVLf4.js";const ct=Object.prototype.toString;function it(a){return ct.call(a)==="[object String]"}const lt=a=>{const{name:t,id:l,path:e,params:i}=a;return{name:t||"",id:String(l),path:e,params:i}},te=se("tabBar",{state:()=>({cacheTabList:new Set(["home"]),tagList:[{name:Ze.global.t("home"),id:"home",path:"/home",params:{}}]}),getters:{getTabList(){return this.tagList},getCacheList(){return Array.from(this.cacheTabList)}},actions:{updateTabList(a){this.tagList.push(lt(a)),this.cacheTabList.add(a.id)},deleteTag(a,t){this.tagList.splice(a,1),this.cacheTabList.delete(t.name)},addCache(a){it(a)&&a!==""&&this.cacheTabList.add(a)},deleteCache(a){this.cacheTabList.delete(a.name)},freshTabList(a){this.tagList=a,this.cacheTabList.clear(),this.tagList.filter(t=>!t.ignoreCache).map(t=>t.name).forEach(t=>this.cacheTabList.add(t))},resetTabList(){this.tagList=[],this.cacheTabList.clear(),this.cacheTabList.add("home")}}}),rt=R({__name:"PageBreadcrumb",setup(a){const{pageBreadcrumb:t}=ce(et());return(l,e)=>{const i=ie,h=le,p=re;return _(),y(p,{class:"container-breadcrumb"},{default:s(()=>[o(h,null,{default:s(()=>[o(i)]),_:1}),(_(!0),B(j,null,A(c(t),f=>(_(),y(h,{key:f},{default:s(()=>[G(S(f),1)]),_:2},1024))),128))]),_:1})}}}),ut=F(rt,[["__scopeId","data-v-8a044137"]]),_t={class:"tag-link"},dt=R({__name:"TabItem",props:{itemData:{type:Object,default(){return{}}},index:{type:Number,default:0}},setup(a){const t=a,l=ue(),e=V(),i=te(),h=n=>{l.push({path:n.path,query:n.params})},p=b(()=>i.getTabList),f=b(()=>t.itemData.path!==e.path),u=b(()=>t.index===0),T=b(()=>[0,1].includes(t.index)),L=b(()=>t.index===p.value.length-1),C=(n,d)=>{if(i.deleteTag(d,n),t.itemData.path===e.path){const v=p.value[d-1];l.push({path:v.path,query:v.params})}},w=()=>p.value.findIndex(n=>n.path===e.path),g=async n=>{const{itemData:d,index:v}=t,k=[...p.value];if(n==="current")C(d,v);else if(n==="left"){const r=w();k.splice(1,t.index-1),i.freshTabList(k),r<v&&l.push({name:d.name})}else if(n==="right"){const r=w();k.splice(t.index+1),i.freshTabList(k),r>v&&l.push({name:d.name})}else if(n==="others"){const r=p.value.filter((M,I)=>I===0||I===t.index);i.freshTabList(r),l.push({name:d.name})}else n==="reload"&&location.reload()};return(n,d)=>{const v=_e,k=de,r=J,M=pe,I=me,$=fe,z=he,U=Q;return _(),y(U,{trigger:"contextMenu","popup-max-height":!1,onSelect:g},{content:s(()=>[o(r,{disabled:c(f),value:"reload"},{default:s(()=>[o(k),m("span",null,S(n.$t("zhong_xin_jia_zai")),1)]),_:1},8,["disabled","value"]),o(r,{class:"sperate-line",disabled:c(u),value:"current"},{default:s(()=>[o(M),m("span",null,S(n.$t("guan_bi_dang_qian_biao_q")),1)]),_:1},8,["disabled","value"]),o(r,{disabled:c(T),value:"left"},{default:s(()=>[o(I),m("span",null,S(n.$t("guan_bi_zuo_ce_biao_qian")),1)]),_:1},8,["disabled","value"]),o(r,{class:"sperate-line",disabled:c(L),value:"right"},{default:s(()=>[o($),m("span",null,S(n.$t("guan_bi_you_ce_biao_qian")),1)]),_:1},8,["disabled","value"]),o(r,{value:"others"},{default:s(()=>[o(z),m("span",null,S(n.$t("guan_bi_qi_ta_biao_qian")),1)]),_:1},8,["value"])]),default:s(()=>[o(v,{closable:"",checkable:"",checked:a.itemData.path===n.$route.path,onCheck:d[0]||(d[0]=D=>h(a.itemData)),onClose:d[1]||(d[1]=D=>C(a.itemData,a.index))},{default:s(()=>[m("span",_t,S(a.itemData.name),1)]),_:1},8,["checked"])]),_:1})}}}),pt=F(dt,[["__scopeId","data-v-f5158e18"]]),mt={class:"tab-bar-container"},ft={class:"tab-bar-box"},ht={class:"tab-bar-scroll"},gt={class:"tags-wrap"},bt=R({__name:"TabBar",setup(a){const t=x(),l=te(),e=q(),i=b(()=>l.getTabList),h=b(()=>t.navbar?60:0);return X(()=>t.navbar,()=>{e.value.updatePosition()}),tt(p=>{i.value.some(f=>f.path===p.path)||l.updateTabList(p)},!0),ge(()=>{nt()}),(p,f)=>{const u=pt,T=be;return _(),B("div",mt,[o(T,{ref_key:"affixRef",ref:e,"offset-top":c(h)},{default:s(()=>[m("div",ft,[m("div",ht,[m("div",gt,[(_(!0),B(j,null,A(c(i),(L,C)=>(_(),y(u,{key:L.id,index:C,"item-data":L},null,8,["index","item-data"]))),128))])]),f[0]||(f[0]=m("div",{class:"tag-bar-operation"},null,-1))])]),_:1},8,["offset-top"])])}}}),vt=F(bt,[["__scopeId","data-v-ff93c19a"]]),yt=R({__name:"MenuItem",props:{item:{},showIcon:{type:Boolean}},setup(a){const t=V(),l=e=>{if(e.is_ext){const i=document.createElement("a");e.ext_open_mode=="blank"&&(i.target="_blank"),i.href=e.path,i.click();return}t.path!==e.path&&at.push({path:e.path,query:e.params})};return(e,i)=>{const h=Y("MenuItem",!0),p=ye,f=ke;return e.item.children&&e.item.children.length>0?(_(),y(p,{key:e.item.id},{icon:s(()=>[m("i",{class:P(["text-15",e.item.icon])},null,2)]),title:s(()=>[m("span",null,S(e.item.name),1)]),default:s(()=>[(_(!0),B(j,null,A(e.item.children,u=>(_(),y(h,{key:u.key,item:u,"show-icon":!1},null,8,["item"]))),128))]),_:1})):(_(),y(f,{key:e.item.id,onClick:i[0]||(i[0]=u=>l(e.item))},ve({default:s(()=>[m("span",null,S(e.item.name),1)]),_:2},[e.item.icon&&e.showIcon?{name:"icon",fn:s(()=>[m("i",{class:P(["text-15",e.item.icon])},null,2)]),key:"0"}:void 0]),1024))}}}),kt=()=>{const a=x(),t=b(()=>a.menuFromServer?a.appAsyncMenus:[]);return{menuTree:b(()=>{const e=Le.cloneDeep(t.value);function i(h,p){return h?h.map(u=>{if(!u.children)return u.children=[],u;u.children=u.children.filter(L=>L.show==!0);const T=i(u.children,p+1);return T.length||p>1?(u.children=T,u):u.show?u:null}).filter(Boolean):null}return i(e,0)})}},Lt=R({__name:"PageMenu",setup(a){const t=x(),{menuTree:l}=kt(),e=b({get(){return t.device==="desktop"?t.menuCollapse:!1},set(n){t.updateSettings({menuCollapse:n})}}),i=V(),h=q(!1);K(async()=>{await t.fetchServerMenuConfig(),h.value=!0,C(g.value);const n=x().getMenuItemByUri(i.path);n&&ee(n)});const p=b(()=>t.topMenu),f=Te("admin-open-keys",[]),u=q([]),T=n=>{const d=[];let v=!1;const k=(r,M)=>{var I;if(r.id===n){v=!0,d.push(...M);return}(I=r.children)!=null&&I.length&&r.children.forEach($=>{k($,[...M,$.id])})};return l.value.forEach(r=>{v||k(r,[r.id])}),d},L=n=>{t.device==="desktop"&&t.updateSettings({menuCollapse:n})};X(()=>i.path,()=>{C(g.value)});const C=n=>{n&&(!n.show&&n.active_menu?u.value=[n.active_menu]:u.value=[n.id],w(T(n.id)))},w=n=>{n.forEach(d=>{f.value.includes(d)||f.value.push(d)})},g=b(()=>x().getMenuItemByUri(i.path));return(n,d)=>{const v=yt,k=we;return c(h)?(_(),y(k,{key:0,mode:c(p)?"horizontal":"vertical",collapsed:c(e),"onUpdate:collapsed":d[0]||(d[0]=r=>H(e)?e.value=r:null),"open-keys":c(f),"onUpdate:openKeys":d[1]||(d[1]=r=>H(f)?f.value=r:null),"show-collapse-button":c(t).device!=="mobile","auto-open":!1,"selected-keys":c(u),"auto-open-selected":!0,"level-indent":34,style:{height:"100%",width:"100%"},onCollapse:L,class:"select-none"},{default:s(()=>[(_(!0),B(j,null,A(c(l),r=>(_(),y(v,{key:r.key,item:r,"show-icon":!0},null,8,["item"]))),128))]),_:1},8,["mode","collapsed","open-keys","show-collapse-button","selected-keys"])):E("",!0)}}}),Tt=F(Lt,[["__scopeId","data-v-c46ecbf9"]]),wt={class:"navbar"},It={class:"left-side"},St={class:"right-side"},Ct=["src"],Mt=R({__name:"NavBar",setup(a){const t=x(),l=ot(),{isFullscreen:e,toggle:i}=Ie(),h=b(()=>l.avatar),p=b(()=>t.theme);K(()=>{});const f=b(()=>t.topMenu&&t.menu),u=Se({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(g){t.toggleTheme(g)}}),T=Ce(u),L=()=>{T(),location.reload()},C=()=>{l.logout()},w=Me("toggleDrawerMenu");return(g,n)=>{const d=$e,v=Z,k=st,r=Be,M=De,I=xe,$=Re,z=Ee,U=qe,D=Fe,N=ze,ne=Ue,O=J,ae=je,oe=Q;return _(),B("div",wt,[m("div",It,[o(v,null,{default:s(()=>[!c(f)&&c(t).device==="mobile"?(_(),y(d,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:c(w)},null,8,["onClick"])):E("",!0)]),_:1})]),m("ul",St,[m("li",null,[o(k)]),m("li",null,[o($,{content:c(p)==="light"?g.$t("dian_ji_qie_huan_wei_an"):g.$t("dian_ji_qie_huan_wei_lia")},{default:s(()=>[o(I,{class:"nav-btn",type:"outline",shape:"circle",onClick:L},{icon:s(()=>[c(p)==="dark"?(_(),y(r,{key:0})):(_(),y(M,{key:1}))]),_:1})]),_:1},8,["content"])]),m("li",null,[o($,{content:c(e)?g.$t("dian_ji_tui_chu_quan_pin"):g.$t("dian_ji_qie_huan_quan_pi")},{default:s(()=>[o(I,{class:"nav-btn",type:"outline",shape:"circle",onClick:c(i)},{icon:s(()=>[c(e)?(_(),y(z,{key:0})):(_(),y(U,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),m("li",null,[o(oe,{trigger:"click"},{content:s(()=>[o(O,null,{default:s(()=>[o(v,{onClick:n[0]||(n[0]=Kt=>g.$router.push("/userSetting"))},{default:s(()=>[o(ne),m("span",null,S(g.$t("yong_hu_she_zhi")),1)]),_:1})]),_:1}),o(O,null,{default:s(()=>[o(v,{onClick:C},{default:s(()=>[o(ae),m("span",null,S(g.$t("tui_chu_deng_lu")),1)]),_:1})]),_:1})]),default:s(()=>[o(N,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:s(()=>[c(h)?(_(),B("img",{key:0,alt:"avatar",src:c(h)},null,8,Ct)):(_(),y(D,{key:1}))]),_:1})]),_:1})])])])}}}),$t=F(Mt,[["__scopeId","data-v-6119b0e3"]]);function Bt(a,t,l,e=!1){a.addEventListener&&typeof a.addEventListener=="function"&&a.addEventListener(t,l,e)}function Dt(a,t,l,e=!1){a.removeEventListener&&typeof a.removeEventListener=="function"&&a.removeEventListener(t,l,e)}const xt=992;function Rt(){return document.body.getBoundingClientRect().width-1<xt}const Et=a=>{const t=x();function l(){if(!document.hidden){const i=Rt();t.toggleDevice(i?"mobile":"desktop"),t.toggleMenu(i)}}const e=Ae(l,100);K(()=>{e()}),Ke(()=>{Bt(window,"resize",e)}),Ne(()=>{Dt(window,"resize",e)})},qt={key:0,class:"layout-navbar"},Ft={class:"menu-wrapper"},zt={class:"left-side"},Ut=["src"],jt="60px",At=R({__name:"BaseLayout",setup(a){const t=q(window.AmisAdmin),l=q(!1),e=x();Et();const i=b(()=>e.navbar),h=b(()=>e.menu&&!e.topMenu),p=b(()=>e.hideMenu),f=b(()=>e.menuCollapse?48:e.menuWidth),u=b(()=>{const w=h.value&&!p.value?{paddingLeft:`${f.value}px`}:{},g=i.value?{paddingTop:jt}:{};return{...w,...g}}),T=w=>{l.value&&e.updateSettings({menuCollapse:w})},L=q(!1),C=()=>{L.value=!1};return Ve("toggleDrawerMenu",()=>{L.value=!L.value}),K(()=>{l.value=!0}),Pe(w=>{const g=e.getMenuItemByUri(w.path);g&&ee(g)}),(w,g)=>{const n=$t,d=Je,v=Z,k=Tt,r=Qe,M=Xe,I=vt,$=ut,z=Y("router-view"),U=Ye,D=Oe;return _(),y(D,{class:P(["layout",{mobile:c(e).hideMenu}])},{default:s(()=>[c(i)?(_(),B("div",qt,[o(n)])):E("",!0),o(D,null,{default:s(()=>[o(D,null,{default:s(()=>[c(h)?He((_(),y(r,{key:0,class:"layout-sider",breakpoint:"xl",collapsible:!0,width:c(f),style:W({paddingTop:c(i)?"60px":""}),"hide-trigger":!0,onCollapse:T},{default:s(()=>[m("div",Ft,[m("div",zt,[o(v,null,{default:s(()=>[c(t).logo?(_(),B("img",{key:0,alt:"logo",src:c(t).logo},null,8,Ut)):E("",!0),o(d,null,{default:s(()=>[G(S(c(t).title),1)]),_:1})]),_:1})]),o(k)])]),_:1},8,["width","style"])),[[We,!c(p)]]):E("",!0),c(p)?(_(),y(M,{key:1,visible:c(L),placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:C},{default:s(()=>[o(k)]),_:1},8,["visible"])):E("",!0),o(D,{class:"layout-content",style:W(c(u))},{default:s(()=>[o(I),o(U,null,{default:s(()=>[o($,{class:"px-10"}),o(z,null,{default:s(({Component:N})=>[(_(),y(Ge(N)))]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}}),Ot=F(At,[["__scopeId","data-v-38b3b37a"]]);export{Ot as default};
