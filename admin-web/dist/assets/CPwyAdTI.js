import{k,o as _,l as x,a as d,A as q,w as y,q as g,au as J,a9 as O,b as V,f as P,x as $,y as T,Y as E,Q as L,s as N,P as S,z,av as I,p as n,c as w,$ as b}from"./7ce62ioI.js";import{c as B,_ as R,i as M,g as U,d as v,u as C}from"./BpTLdzrt.js";const D={class:"content"},F={class:"operation-row"},G=k({__name:"ExceptionError",props:{title:{},status:{}},setup(t){const e=()=>{B.go(0)},i=()=>{B.back()};return(o,c)=>{const m=J,l=O;return _(),x("div",D,[d(m,{class:"result",status:o.status,subtitle:o.title},null,8,["status","subtitle"]),q("div",F,[d(l,{key:"again",onClick:e,style:{"margin-right":"16px"}},{default:y(()=>[g(" 重试 ")]),_:1}),d(l,{key:"back",type:"primary",onClick:i},{default:y(()=>[g(" 返回 ")]),_:1})])])}}}),H=R(G,[["__scopeId","data-v-3d99c615"]]),j=V.create({timeout:20*1e3,maxBodyLength:5*1024*1024,withCredentials:!0});j.interceptors.request.use(t=>(M()&&(t.headers={...t.headers,Authorization:`Bearer ${U()}`}),t.params={...t.params},t),function(t){return Promise.reject(t)});j.interceptors.response.use(t=>{const{status:e}=t.data;return e!==0?e===401?(v().logoutCallBack(),Promise.reject({data:{status:401,message:"未登录"}})):e===404?Promise.reject({data:{status:404,message:"抱歉，页面不见了～"}}):e===403?Promise.reject({data:{status:403,message:"对不起，您没有访问该资源的权限"}}):e===500?Promise.reject({data:{status:500,message:"抱歉，服务器出了点问题～"}}):Promise.reject(t.data):t},function(t){if(t.response){const{status:e}=t.response;if(e===401)return v().logoutCallBack(),Promise.reject({data:{status:401,message:"未登录"}});if(e===404)return Promise.reject({data:{status:404,message:"抱歉，页面不见了～"}});if(e===403)return Promise.reject({data:{status:403,message:"对不起，您没有访问该资源的权限"}});if(e===500)return Promise.reject({data:{status:500,message:"抱歉，服务器出了点问题～"}})}return Promise.reject(t.response)});const A=j,Q=k({__name:"AmisRenderer",props:{amisJson:{}},setup(t){const e=window.amisRequire("amis/embed"),i=P(null),o=t,c=$(),m=T(),l=P(null),f=()=>{l.value=e.embed(i.value,o.amisJson,{},{fetcher:({url:a,method:u,data:r,responseType:p,config:s,headers:h})=>(s=s||{},s.withCredentials=!0,p&&(s.responseType=p),s.headers=h||{},u!=="post"&&u!=="put"&&u!=="patch"?(r&&(s.params=r),A[u](a,s)):(r&&r instanceof FormData?(s.headers=s.headers||{},s.headers["Content-Type"]="multipart/form-data"):r&&typeof r!="string"&&!(r instanceof Blob)&&!(r instanceof ArrayBuffer)&&(r=JSON.stringify(r),s.headers=s.headers||{},s.headers["Content-Type"]="application/json"),A[u](a,r,s))),jumpTo:a=>{if(a=="back()"){c.back();return}if(a.indexOf("http://")==0||a.indexOf("https://")==0){window.location.href=a;return}c.push(a)},updateLocation:(a,u)=>{let p=a.split("&").filter(h=>h.indexOf("search[")===-1).join("&");p.indexOf("?")!==0&&(p="?"+p);const s=m.path+p;u?c.replace(s):c.push(s)},affixOffsetTop:48})};return E(()=>f()),L(()=>{var a;(a=l.value)==null||a.unmount()}),(a,u)=>(_(),x("div",{class:"amis-main",ref_key:"amisEL",ref:i},null,512))}}),Y={class:"main-container"},K=k({__name:"AmisView",setup(t){const{thisPage:e}=N(C()),{getPageJson:i}=C(),o=T();S(()=>o.path,async m=>{await i(m)}),E(async()=>{await i(o.path)});const c=z(()=>e.value.status.toString());return(m,l)=>{const f=Q,a=H;return _(),x("div",Y,[d(I,{name:"fade"},{default:y(()=>[!n(e).error&&n(e).pageJson&&!n(e).loading?(_(),w(f,{key:n(o).path,"amis-json":n(e).pageJson},null,8,["amis-json"])):b("",!0),n(e).error&&!n(e).loading?(_(),w(a,{key:1,title:n(e).errorMessage,status:n(c)},null,8,["title","status"])):b("",!0)]),_:1})])}}}),Z=R(K,[["__scopeId","data-v-e1eb617f"]]);export{Z as default};
