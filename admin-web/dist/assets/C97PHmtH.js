import{d as le,k as D,s as re,o as d,c as b,w as o,a,l as M,F as N,n as P,p as c,q as X,t as z,I as ie,B as ue,v as de,x as pe,y as O,z as g,A as m,T as _e,D as me,E as Y,G as fe,H as he,J as ge,K as ve,L as Z,M as H,O as W,f as E,P as ee,Q as be,R as ye,r as te,S as j,U as ke,V as Le,W as Te,X as Ie,Y as q,Z as Se,_ as J,$ as R,a0 as we,a1 as Ce,a2 as Me,a3 as xe,a4 as $e,a5 as Be,a6 as ne,a7 as De,a8 as Re,a9 as Ee,aa as Fe,ab as Ae,ac as Ue,ad as ze,ae as Ke,af as Ne,ag as Pe,ah as qe,ai as Ve,aj as je,ak as Oe,al as He,am as We,an as Ge,ao as Q,ap as Je,aq as Qe,ar as Xe,as as Ye,at as Ze}from"./CG0sQdSw.js";import{u as et,_ as F,a as B,l as tt,r as nt,b as ot,s as at,c as st}from"./DcTOGpb2.js";const ct=Object.prototype.toString;function lt(t){return ct.call(t)==="[object String]"}const rt=t=>{const{name:n,id:r,path:e,params:l}=t;return{name:n||"",id:String(r),path:e,params:l}},oe=le("tabBar",{state:()=>({cacheTabList:new Set(["home"]),tagList:[{name:"工作台",id:"home",path:"/home",params:{}}]}),getters:{getTabList(){return this.tagList},getCacheList(){return Array.from(this.cacheTabList)}},actions:{updateTabList(t){this.tagList.push(rt(t)),this.cacheTabList.add(t.id)},deleteTag(t,n){this.tagList.splice(t,1),this.cacheTabList.delete(n.name)},addCache(t){lt(t)&&t!==""&&this.cacheTabList.add(t)},deleteCache(t){this.cacheTabList.delete(t.name)},freshTabList(t){this.tagList=t,this.cacheTabList.clear(),this.tagList.filter(n=>!n.ignoreCache).map(n=>n.name).forEach(n=>this.cacheTabList.add(n))},resetTabList(){this.tagList=[],this.cacheTabList.clear(),this.cacheTabList.add("home")}}}),it=D({__name:"PageBreadcrumb",setup(t){const{pageBreadcrumb:n}=re(et());return(r,e)=>{const l=ie,h=ue,_=de;return d(),b(_,{class:"container-breadcrumb"},{default:o(()=>[a(h,null,{default:o(()=>[a(l)]),_:1}),(d(!0),M(N,null,P(c(n),f=>(d(),b(h,{key:f},{default:o(()=>[X(z(f),1)]),_:2},1024))),128))]),_:1})}}}),ut=F(it,[["__scopeId","data-v-8a044137"]]),K=t=>(H("data-v-82964898"),t=t(),W(),t),dt={class:"tag-link"},pt=K(()=>m("span",null,"重新加载",-1)),_t=K(()=>m("span",null,"关闭当前标签页",-1)),mt=K(()=>m("span",null,"关闭左侧标签页",-1)),ft=K(()=>m("span",null,"关闭右侧标签页",-1)),ht=K(()=>m("span",null,"关闭其它标签页",-1)),gt=D({__name:"TabItem",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(t){const n=t,r=pe(),e=O(),l=oe(),h=s=>{r.push({path:s.path,query:s.params})},_=g(()=>l.getTabList),f=g(()=>n.itemData.path!==e.path),u=g(()=>n.index===0),L=g(()=>[0,1].includes(n.index)),k=g(()=>n.index===_.value.length-1),I=(s,p)=>{if(l.deleteTag(p,s),n.itemData.path===e.path){const v=_.value[p-1];r.push({path:v.path,query:v.params})}},S=()=>_.value.findIndex(s=>s.path===e.path),w=async s=>{const{itemData:p,index:v}=n,y=[..._.value];if(s==="current")I(p,v);else if(s==="left"){const i=S();y.splice(1,n.index-1),l.freshTabList(y),i<v&&r.push({name:p.name})}else if(s==="right"){const i=S();y.splice(n.index+1),l.freshTabList(y),i>v&&r.push({name:p.name})}else if(s==="others"){const i=_.value.filter((C,T)=>T===0||T===n.index);l.freshTabList(i),r.push({name:p.name})}else s==="reload"&&location.reload()};return(s,p)=>{const v=_e,y=me,i=Y,C=fe,T=he,x=ge,A=ve,U=Z;return d(),b(U,{trigger:"contextMenu","popup-max-height":!1,onSelect:w},{content:o(()=>[a(i,{disabled:c(f),value:"reload"},{default:o(()=>[a(y),pt]),_:1},8,["disabled","value"]),a(i,{class:"sperate-line",disabled:c(u),value:"current"},{default:o(()=>[a(C),_t]),_:1},8,["disabled","value"]),a(i,{disabled:c(L),value:"left"},{default:o(()=>[a(T),mt]),_:1},8,["disabled","value"]),a(i,{class:"sperate-line",disabled:c(k),value:"right"},{default:o(()=>[a(x),ft]),_:1},8,["disabled","value"]),a(i,{value:"others"},{default:o(()=>[a(A),ht]),_:1},8,["value"])]),default:o(()=>[a(v,{closable:"",checkable:"",checked:t.itemData.path===s.$route.path,onCheck:p[0]||(p[0]=$=>h(t.itemData)),onClose:p[1]||(p[1]=$=>I(t.itemData,t.index))},{default:o(()=>[m("span",dt,z(t.itemData.name),1)]),_:1},8,["checked"])]),_:1})}}}),vt=F(gt,[["__scopeId","data-v-82964898"]]),bt=t=>(H("data-v-ff93c19a"),t=t(),W(),t),yt={class:"tab-bar-container"},kt={class:"tab-bar-box"},Lt={class:"tab-bar-scroll"},Tt={class:"tags-wrap"},It=bt(()=>m("div",{class:"tag-bar-operation"},null,-1)),St=D({__name:"TabBar",setup(t){const n=B(),r=oe(),e=E(),l=g(()=>r.getTabList),h=g(()=>n.navbar?60:0);return ee(()=>n.navbar,()=>{e.value.updatePosition()}),tt(_=>{l.value.some(f=>f.path===_.path)||r.updateTabList(_)},!0),be(()=>{nt()}),(_,f)=>{const u=vt,L=ye;return d(),M("div",yt,[a(L,{ref_key:"affixRef",ref:e,"offset-top":c(h)},{default:o(()=>[m("div",kt,[m("div",Lt,[m("div",Tt,[(d(!0),M(N,null,P(c(l),(k,I)=>(d(),b(u,{key:k.id,index:I,"item-data":k},null,8,["index","item-data"]))),128))])]),It])]),_:1},8,["offset-top"])])}}}),wt=F(St,[["__scopeId","data-v-ff93c19a"]]),Ct=D({__name:"MenuItem",props:{item:{},showIcon:{type:Boolean}},setup(t){const n=O(),r=e=>{if(e.is_ext){const l=document.createElement("a");e.ext_open_mode=="blank"&&(l.target="_blank"),l.href=e.path,l.click();return}n.path!==e.path&&ot.push({path:e.path,query:e.params})};return(e,l)=>{const h=te("MenuItem",!0),_=Le,f=Te;return e.item.children&&e.item.children.length>0?(d(),b(_,{key:e.item.id},{icon:o(()=>[m("i",{class:j(["text-15",e.item.icon])},null,2)]),title:o(()=>[m("span",null,z(e.item.name),1)]),default:o(()=>[(d(!0),M(N,null,P(e.item.children,u=>(d(),b(h,{key:u.key,item:u,"show-icon":!1},null,8,["item"]))),128))]),_:1})):(d(),b(f,{key:e.item.id,onClick:l[0]||(l[0]=u=>r(e.item))},ke({default:o(()=>[m("span",null,z(e.item.name),1)]),_:2},[e.item.icon&&e.showIcon?{name:"icon",fn:o(()=>[m("i",{class:j(["text-15",e.item.icon])},null,2)]),key:"0"}:void 0]),1024))}}}),Mt=()=>{const t=B(),n=g(()=>t.menuFromServer?t.appAsyncMenus:[]);return{menuTree:g(()=>{const e=Ie.cloneDeep(n.value);function l(h,_){return h?h.map(u=>{if(!u.children)return u.children=[],u;u.children=u.children.filter(k=>k.show==!0);const L=l(u.children,_+1);return L.length||_>1?(u.children=L,u):u.show?u:null}).filter(Boolean):null}return l(e,0)})}},xt=D({__name:"PageMenu",setup(t){const n=B(),{menuTree:r}=Mt(),e=g({get(){return n.device==="desktop"?n.menuCollapse:!1},set(s){n.updateSettings({menuCollapse:s})}}),l=O(),h=E(!1);q(async()=>{await n.fetchServerMenuConfig(),h.value=!0,I(w.value);const s=B().getMenuItemByUri(l.path);s&&at(s)});const _=g(()=>n.topMenu),f=Se("admin-open-keys",[]),u=E([]),L=s=>{const p=[];let v=!1;const y=(i,C)=>{var T;if(i.id===s){v=!0,p.push(...C);return}(T=i.children)!=null&&T.length&&i.children.forEach(x=>{y(x,[...C,x.id])})};return r.value.forEach(i=>{v||y(i,[i.id])}),p},k=s=>{n.device==="desktop"&&n.updateSettings({menuCollapse:s})};ee(()=>l.path,()=>{I(w.value)});const I=s=>{s&&(!s.show&&s.active_menu?u.value=[s.active_menu]:u.value=[s.id],S(L(s.id)))},S=s=>{s.forEach(p=>{f.value.includes(p)||f.value.push(p)})},w=g(()=>B().getMenuItemByUri(l.path));return(s,p)=>{const v=Ct,y=we;return c(h)?(d(),b(y,{key:0,mode:c(_)?"horizontal":"vertical",collapsed:c(e),"onUpdate:collapsed":p[0]||(p[0]=i=>J(e)?e.value=i:null),"open-keys":c(f),"onUpdate:openKeys":p[1]||(p[1]=i=>J(f)?f.value=i:null),"show-collapse-button":c(n).device!=="mobile","auto-open":!1,"selected-keys":c(u),"auto-open-selected":!0,"level-indent":34,style:{height:"100%",width:"100%"},onCollapse:k,class:"select-none"},{default:o(()=>[(d(!0),M(N,null,P(c(r),i=>(d(),b(v,{key:i.key,item:i,"show-icon":!0},null,8,["item"]))),128))]),_:1},8,["mode","collapsed","open-keys","show-collapse-button","selected-keys"])):R("",!0)}}}),$t=F(xt,[["__scopeId","data-v-c46ecbf9"]]),ae=t=>(H("data-v-effd5f04"),t=t(),W(),t),Bt={class:"navbar"},Dt={class:"left-side"},Rt={class:"right-side"},Et=["src"],Ft=ae(()=>m("span",null," 用户设置 ",-1)),At=ae(()=>m("span",null," 退出登录 ",-1)),Ut=D({__name:"NavBar",setup(t){const n=B(),r=st(),{isFullscreen:e,toggle:l}=Ce(),h=g(()=>r.avatar),_=g(()=>n.theme);q(()=>{});const f=g(()=>n.topMenu&&n.menu),u=Me({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(w){n.toggleTheme(w)}}),L=xe(u),k=()=>{L(),location.reload()},I=()=>{r.logout()},S=$e("toggleDrawerMenu");return(w,s)=>{const p=Be,v=ne,y=De,i=Re,C=Ee,T=Fe,x=Ae,A=Ue,U=ze,$=Ke,V=Ne,G=Y,se=Pe,ce=Z;return d(),M("div",Bt,[m("div",Dt,[a(v,null,{default:o(()=>[!c(f)&&c(n).device==="mobile"?(d(),b(p,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:c(S)},null,8,["onClick"])):R("",!0)]),_:1})]),m("ul",Rt,[m("li",null,[a(T,{content:c(_)==="light"?"点击切换为暗黑模式":"点击切换为亮色模式"},{default:o(()=>[a(C,{class:"nav-btn",type:"outline",shape:"circle",onClick:k},{icon:o(()=>[c(_)==="dark"?(d(),b(y,{key:0})):(d(),b(i,{key:1}))]),_:1})]),_:1},8,["content"])]),m("li",null,[a(T,{content:c(e)?"点击退出全屏模式":"点击切换全屏模式"},{default:o(()=>[a(C,{class:"nav-btn",type:"outline",shape:"circle",onClick:c(l)},{icon:o(()=>[c(e)?(d(),b(x,{key:0})):(d(),b(A,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),m("li",null,[a(ce,{trigger:"click"},{content:o(()=>[a(G,null,{default:o(()=>[a(v,{onClick:s[0]||(s[0]=Qt=>w.$router.push("/userSetting"))},{default:o(()=>[a(V),Ft]),_:1})]),_:1}),a(G,null,{default:o(()=>[a(v,{onClick:I},{default:o(()=>[a(se),At]),_:1})]),_:1})]),default:o(()=>[a($,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:o(()=>[c(h)?(d(),M("img",{key:0,alt:"avatar",src:c(h)},null,8,Et)):(d(),b(U,{key:1}))]),_:1})]),_:1})])])])}}}),zt=F(Ut,[["__scopeId","data-v-effd5f04"]]);function Kt(t,n,r,e=!1){t.addEventListener&&typeof t.addEventListener=="function"&&t.addEventListener(n,r,e)}function Nt(t,n,r,e=!1){t.removeEventListener&&typeof t.removeEventListener=="function"&&t.removeEventListener(n,r,e)}const Pt=992;function qt(){return document.body.getBoundingClientRect().width-1<Pt}const Vt=t=>{const n=B();function r(){if(!document.hidden){const l=qt();n.toggleDevice(l?"mobile":"desktop"),n.toggleMenu(l)}}const e=qe(r,100);q(()=>{e()}),Ve(()=>{Kt(window,"resize",e)}),je(()=>{Nt(window,"resize",e)})},jt={key:0,class:"layout-navbar"},Ot={class:"menu-wrapper"},Ht={class:"left-side"},Wt=["src"],Gt="60px",Jt=D({__name:"BaseLayout",setup(t){const n=E(window.AmisAdmin),r=E(!1),e=B();Vt();const l=g(()=>e.navbar),h=g(()=>e.menu&&!e.topMenu),_=g(()=>e.hideMenu),f=g(()=>e.menuCollapse?48:e.menuWidth),u=g(()=>{const S=h.value&&!_.value?{paddingLeft:`${f.value}px`}:{},w=l.value?{paddingTop:Gt}:{};return{...S,...w}}),L=S=>{r.value&&e.updateSettings({menuCollapse:S})},k=E(!1),I=()=>{k.value=!1};return Oe("toggleDrawerMenu",()=>{k.value=!k.value}),q(()=>{r.value=!0}),(S,w)=>{const s=zt,p=Qe,v=ne,y=$t,i=Xe,C=Ye,T=wt,x=ut,A=te("router-view"),U=Ze,$=He;return d(),b($,{class:j(["layout",{mobile:c(e).hideMenu}])},{default:o(()=>[c(l)?(d(),M("div",jt,[a(s)])):R("",!0),a($,null,{default:o(()=>[a($,null,{default:o(()=>[c(h)?We((d(),b(i,{key:0,class:"layout-sider",breakpoint:"xl",collapsible:!0,width:c(f),style:Q({paddingTop:c(l)?"60px":""}),"hide-trigger":!0,onCollapse:L},{default:o(()=>[m("div",Ot,[m("div",Ht,[a(v,null,{default:o(()=>[c(n).logo?(d(),M("img",{key:0,alt:"logo",src:c(n).logo},null,8,Wt)):R("",!0),a(p,null,{default:o(()=>[X(z(c(n).title),1)]),_:1})]),_:1})]),a(y)])]),_:1},8,["width","style"])),[[Ge,!c(_)]]):R("",!0),c(_)?(d(),b(C,{key:1,visible:c(k),placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:I},{default:o(()=>[a(y)]),_:1},8,["visible"])):R("",!0),a($,{class:"layout-content",style:Q(c(u))},{default:o(()=>[a(T),a(U,null,{default:o(()=>[a(x,{class:"px-10"}),a(A,null,{default:o(({Component:V})=>[(d(),b(Je(V)))]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}}),Zt=F(Jt,[["__scopeId","data-v-4b3ae35b"]]);export{Zt as default};
