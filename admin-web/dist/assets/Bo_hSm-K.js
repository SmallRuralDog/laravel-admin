import{e as oe,l as $,s as ae,o as p,c as b,w as a,a as s,n as M,F as K,p as N,q as l,x as G,y as z,I as se,B as ce,z as le,A as re,D as j,E as g,G as f,T as ie,H as ue,J,K as de,L as pe,M as _e,O as me,P as Q,g as E,Q as X,R as fe,S as he,r as Y,U as V,V as ge,W as ve,X as be,Y as ye,Z as P,_ as ke,$ as H,a0 as R,a1 as Le,a2 as Te,a3 as we,a4 as Ce,a5 as Ie,a6 as Se,a7 as Z,a8 as Me,a9 as xe,aa as Be,ab as De,ac as $e,ad as Re,ae as Ee,af as Fe,ag as Ae,ah as Ue,ai as ze,aj as Ke,ak as Ne,al as Pe,am as qe,an as Ve,ao as je,ap as W,aq as Oe,ar as He,as as We,at as Ge,au as Je}from"./JA_6wDNe.js";import{u as Qe,_ as F,a as D,l as Xe,r as Ye,b as Ze,s as et}from"./C34trU7q.js";import{u as tt}from"./Bj4tzhZR.js";const nt=Object.prototype.toString;function ot(n){return nt.call(n)==="[object String]"}const at=n=>{const{name:t,id:i,path:e,params:r}=n;return{name:t||"",id:String(i),path:e,params:r}},ee=oe("tabBar",{state:()=>({cacheTabList:new Set(["home"]),tagList:[{name:"工作台",id:"home",path:"/home",params:{}}]}),getters:{getTabList(){return this.tagList},getCacheList(){return Array.from(this.cacheTabList)}},actions:{updateTabList(n){this.tagList.push(at(n)),this.cacheTabList.add(n.id)},deleteTag(n,t){this.tagList.splice(n,1),this.cacheTabList.delete(t.name)},addCache(n){ot(n)&&n!==""&&this.cacheTabList.add(n)},deleteCache(n){this.cacheTabList.delete(n.name)},freshTabList(n){this.tagList=n,this.cacheTabList.clear(),this.tagList.filter(t=>!t.ignoreCache).map(t=>t.name).forEach(t=>this.cacheTabList.add(t))},resetTabList(){this.tagList=[],this.cacheTabList.clear(),this.cacheTabList.add("home")}}}),st=$({__name:"PageBreadcrumb",setup(n){const{pageBreadcrumb:t}=ae(Qe());return(i,e)=>{const r=se,h=ce,_=le;return p(),b(_,{class:"container-breadcrumb"},{default:a(()=>[s(h,null,{default:a(()=>[s(r)]),_:1}),(p(!0),M(K,null,N(l(t),m=>(p(),b(h,{key:m},{default:a(()=>[G(z(m),1)]),_:2},1024))),128))]),_:1})}}}),ct=F(st,[["__scopeId","data-v-8a044137"]]),lt={class:"tag-link"},rt=$({__name:"TabItem",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(n){const t=n,i=re(),e=j(),r=ee(),h=o=>{i.push({path:o.path,query:o.params})},_=g(()=>r.getTabList),m=g(()=>t.itemData.path!==e.path),d=g(()=>t.index===0),L=g(()=>[0,1].includes(t.index)),k=g(()=>t.index===_.value.length-1),w=(o,c)=>{if(r.deleteTag(c,o),t.itemData.path===e.path){const v=_.value[c-1];i.push({path:v.path,query:v.params})}},C=()=>_.value.findIndex(o=>o.path===e.path),I=async o=>{const{itemData:c,index:v}=t,y=[..._.value];if(o==="current")w(c,v);else if(o==="left"){const u=C();y.splice(1,t.index-1),r.freshTabList(y),u<v&&i.push({name:c.name})}else if(o==="right"){const u=C();y.splice(t.index+1),r.freshTabList(y),u>v&&i.push({name:c.name})}else if(o==="others"){const u=_.value.filter((S,T)=>T===0||T===t.index);r.freshTabList(u),i.push({name:c.name})}else o==="reload"&&location.reload()};return(o,c)=>{const v=ie,y=ue,u=J,S=de,T=pe,x=_e,A=me,U=Q;return p(),b(U,{trigger:"contextMenu","popup-max-height":!1,onSelect:I},{content:a(()=>[s(u,{disabled:l(m),value:"reload"},{default:a(()=>[s(y),c[2]||(c[2]=f("span",null,"重新加载",-1))]),_:1},8,["disabled","value"]),s(u,{class:"sperate-line",disabled:l(d),value:"current"},{default:a(()=>[s(S),c[3]||(c[3]=f("span",null,"关闭当前标签页",-1))]),_:1},8,["disabled","value"]),s(u,{disabled:l(L),value:"left"},{default:a(()=>[s(T),c[4]||(c[4]=f("span",null,"关闭左侧标签页",-1))]),_:1},8,["disabled","value"]),s(u,{class:"sperate-line",disabled:l(k),value:"right"},{default:a(()=>[s(x),c[5]||(c[5]=f("span",null,"关闭右侧标签页",-1))]),_:1},8,["disabled","value"]),s(u,{value:"others"},{default:a(()=>[s(A),c[6]||(c[6]=f("span",null,"关闭其它标签页",-1))]),_:1},8,["value"])]),default:a(()=>[s(v,{closable:"",checkable:"",checked:n.itemData.path===o.$route.path,onCheck:c[0]||(c[0]=B=>h(n.itemData)),onClose:c[1]||(c[1]=B=>w(n.itemData,n.index))},{default:a(()=>[f("span",lt,z(n.itemData.name),1)]),_:1},8,["checked"])]),_:1})}}}),it=F(rt,[["__scopeId","data-v-82964898"]]),ut={class:"tab-bar-container"},dt={class:"tab-bar-box"},pt={class:"tab-bar-scroll"},_t={class:"tags-wrap"},mt=$({__name:"TabBar",setup(n){const t=D(),i=ee(),e=E(),r=g(()=>i.getTabList),h=g(()=>t.navbar?60:0);return X(()=>t.navbar,()=>{e.value.updatePosition()}),Xe(_=>{r.value.some(m=>m.path===_.path)||i.updateTabList(_)},!0),fe(()=>{Ye()}),(_,m)=>{const d=it,L=he;return p(),M("div",ut,[s(L,{ref_key:"affixRef",ref:e,"offset-top":l(h)},{default:a(()=>[f("div",dt,[f("div",pt,[f("div",_t,[(p(!0),M(K,null,N(l(r),(k,w)=>(p(),b(d,{key:k.id,index:w,"item-data":k},null,8,["index","item-data"]))),128))])]),m[0]||(m[0]=f("div",{class:"tag-bar-operation"},null,-1))])]),_:1},8,["offset-top"])])}}}),ft=F(mt,[["__scopeId","data-v-ff93c19a"]]),ht=$({__name:"MenuItem",props:{item:{},showIcon:{type:Boolean}},setup(n){const t=j(),i=e=>{if(e.is_ext){const r=document.createElement("a");e.ext_open_mode=="blank"&&(r.target="_blank"),r.href=e.path,r.click();return}t.path!==e.path&&Ze.push({path:e.path,query:e.params})};return(e,r)=>{const h=Y("MenuItem",!0),_=ve,m=be;return e.item.children&&e.item.children.length>0?(p(),b(_,{key:e.item.id},{icon:a(()=>[f("i",{class:V(["text-15",e.item.icon])},null,2)]),title:a(()=>[f("span",null,z(e.item.name),1)]),default:a(()=>[(p(!0),M(K,null,N(e.item.children,d=>(p(),b(h,{key:d.key,item:d,"show-icon":!1},null,8,["item"]))),128))]),_:1})):(p(),b(m,{key:e.item.id,onClick:r[0]||(r[0]=d=>i(e.item))},ge({default:a(()=>[f("span",null,z(e.item.name),1)]),_:2},[e.item.icon&&e.showIcon?{name:"icon",fn:a(()=>[f("i",{class:V(["text-15",e.item.icon])},null,2)]),key:"0"}:void 0]),1024))}}}),gt=()=>{const n=D(),t=g(()=>n.menuFromServer?n.appAsyncMenus:[]);return{menuTree:g(()=>{const e=ye.cloneDeep(t.value);function r(h,_){return h?h.map(d=>{if(!d.children)return d.children=[],d;d.children=d.children.filter(k=>k.show==!0);const L=r(d.children,_+1);return L.length||_>1?(d.children=L,d):d.show?d:null}).filter(Boolean):null}return r(e,0)})}},vt=$({__name:"PageMenu",setup(n){const t=D(),{menuTree:i}=gt(),e=g({get(){return t.device==="desktop"?t.menuCollapse:!1},set(o){t.updateSettings({menuCollapse:o})}}),r=j(),h=E(!1);P(async()=>{await t.fetchServerMenuConfig(),h.value=!0,w(I.value);const o=D().getMenuItemByUri(r.path);o&&et(o)});const _=g(()=>t.topMenu),m=ke("admin-open-keys",[]),d=E([]),L=o=>{const c=[];let v=!1;const y=(u,S)=>{var T;if(u.id===o){v=!0,c.push(...S);return}(T=u.children)!=null&&T.length&&u.children.forEach(x=>{y(x,[...S,x.id])})};return i.value.forEach(u=>{v||y(u,[u.id])}),c},k=o=>{t.device==="desktop"&&t.updateSettings({menuCollapse:o})};X(()=>r.path,()=>{w(I.value)});const w=o=>{o&&(!o.show&&o.active_menu?d.value=[o.active_menu]:d.value=[o.id],C(L(o.id)))},C=o=>{o.forEach(c=>{m.value.includes(c)||m.value.push(c)})},I=g(()=>D().getMenuItemByUri(r.path));return(o,c)=>{const v=ht,y=Le;return l(h)?(p(),b(y,{key:0,mode:l(_)?"horizontal":"vertical",collapsed:l(e),"onUpdate:collapsed":c[0]||(c[0]=u=>H(e)?e.value=u:null),"open-keys":l(m),"onUpdate:openKeys":c[1]||(c[1]=u=>H(m)?m.value=u:null),"show-collapse-button":l(t).device!=="mobile","auto-open":!1,"selected-keys":l(d),"auto-open-selected":!0,"level-indent":34,style:{height:"100%",width:"100%"},onCollapse:k,class:"select-none"},{default:a(()=>[(p(!0),M(K,null,N(l(i),u=>(p(),b(v,{key:u.key,item:u,"show-icon":!0},null,8,["item"]))),128))]),_:1},8,["mode","collapsed","open-keys","show-collapse-button","selected-keys"])):R("",!0)}}}),bt=F(vt,[["__scopeId","data-v-c46ecbf9"]]),yt={class:"navbar"},kt={class:"left-side"},Lt={class:"right-side"},Tt=["src"],wt=$({__name:"NavBar",setup(n){const t=D(),i=tt(),{isFullscreen:e,toggle:r}=Te(),h=g(()=>i.avatar),_=g(()=>t.theme);P(()=>{});const m=g(()=>t.topMenu&&t.menu),d=we({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(I){t.toggleTheme(I)}}),L=Ce(d),k=()=>{L(),location.reload()},w=()=>{i.logout()},C=Ie("toggleDrawerMenu");return(I,o)=>{const c=Se,v=Z,y=Me,u=xe,S=Be,T=De,x=$e,A=Re,U=Ee,B=Fe,q=Ae,O=J,te=Ue,ne=Q;return p(),M("div",yt,[f("div",kt,[s(v,null,{default:a(()=>[!l(m)&&l(t).device==="mobile"?(p(),b(c,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:l(C)},null,8,["onClick"])):R("",!0)]),_:1})]),f("ul",Lt,[f("li",null,[s(T,{content:l(_)==="light"?"点击切换为暗黑模式":"点击切换为亮色模式"},{default:a(()=>[s(S,{class:"nav-btn",type:"outline",shape:"circle",onClick:k},{icon:a(()=>[l(_)==="dark"?(p(),b(y,{key:0})):(p(),b(u,{key:1}))]),_:1})]),_:1},8,["content"])]),f("li",null,[s(T,{content:l(e)?"点击退出全屏模式":"点击切换全屏模式"},{default:a(()=>[s(S,{class:"nav-btn",type:"outline",shape:"circle",onClick:l(r)},{icon:a(()=>[l(e)?(p(),b(x,{key:0})):(p(),b(A,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),f("li",null,[s(ne,{trigger:"click"},{content:a(()=>[s(O,null,{default:a(()=>[s(v,{onClick:o[0]||(o[0]=Ut=>I.$router.push("/userSetting"))},{default:a(()=>[s(q),o[1]||(o[1]=f("span",null," 用户设置 ",-1))]),_:1})]),_:1}),s(O,null,{default:a(()=>[s(v,{onClick:w},{default:a(()=>[s(te),o[2]||(o[2]=f("span",null," 退出登录 ",-1))]),_:1})]),_:1})]),default:a(()=>[s(B,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:a(()=>[l(h)?(p(),M("img",{key:0,alt:"avatar",src:l(h)},null,8,Tt)):(p(),b(U,{key:1}))]),_:1})]),_:1})])])])}}}),Ct=F(wt,[["__scopeId","data-v-effd5f04"]]);function It(n,t,i,e=!1){n.addEventListener&&typeof n.addEventListener=="function"&&n.addEventListener(t,i,e)}function St(n,t,i,e=!1){n.removeEventListener&&typeof n.removeEventListener=="function"&&n.removeEventListener(t,i,e)}const Mt=992;function xt(){return document.body.getBoundingClientRect().width-1<Mt}const Bt=n=>{const t=D();function i(){if(!document.hidden){const r=xt();t.toggleDevice(r?"mobile":"desktop"),t.toggleMenu(r)}}const e=ze(i,100);P(()=>{e()}),Ke(()=>{It(window,"resize",e)}),Ne(()=>{St(window,"resize",e)})},Dt={key:0,class:"layout-navbar"},$t={class:"menu-wrapper"},Rt={class:"left-side"},Et=["src"],Ft="60px",At=$({__name:"BaseLayout",setup(n){const t=E(window.AmisAdmin),i=E(!1),e=D();Bt();const r=g(()=>e.navbar),h=g(()=>e.menu&&!e.topMenu),_=g(()=>e.hideMenu),m=g(()=>e.menuCollapse?48:e.menuWidth),d=g(()=>{const C=h.value&&!_.value?{paddingLeft:`${m.value}px`}:{},I=r.value?{paddingTop:Ft}:{};return{...C,...I}}),L=C=>{i.value&&e.updateSettings({menuCollapse:C})},k=E(!1),w=()=>{k.value=!1};return Pe("toggleDrawerMenu",()=>{k.value=!k.value}),P(()=>{i.value=!0}),(C,I)=>{const o=Ct,c=He,v=Z,y=bt,u=We,S=Ge,T=ft,x=ct,A=Y("router-view"),U=Je,B=qe;return p(),b(B,{class:V(["layout",{mobile:l(e).hideMenu}])},{default:a(()=>[l(r)?(p(),M("div",Dt,[s(o)])):R("",!0),s(B,null,{default:a(()=>[s(B,null,{default:a(()=>[l(h)?Ve((p(),b(u,{key:0,class:"layout-sider",breakpoint:"xl",collapsible:!0,width:l(m),style:W({paddingTop:l(r)?"60px":""}),"hide-trigger":!0,onCollapse:L},{default:a(()=>[f("div",$t,[f("div",Rt,[s(v,null,{default:a(()=>[l(t).logo?(p(),M("img",{key:0,alt:"logo",src:l(t).logo},null,8,Et)):R("",!0),s(c,null,{default:a(()=>[G(z(l(t).title),1)]),_:1})]),_:1})]),s(y)])]),_:1},8,["width","style"])),[[je,!l(_)]]):R("",!0),l(_)?(p(),b(S,{key:1,visible:l(k),placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:w},{default:a(()=>[s(y)]),_:1},8,["visible"])):R("",!0),s(B,{class:"layout-content",style:W(l(d))},{default:a(()=>[s(T),s(U,null,{default:a(()=>[s(x,{class:"px-10"}),s(A,null,{default:a(({Component:q})=>[(p(),b(Oe(q)))]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}}),Pt=F(At,[["__scopeId","data-v-e999c485"]]);export{Pt as default};
